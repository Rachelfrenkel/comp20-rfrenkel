<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script type="text/javascript"
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACyKO5dH-2eU_QZj5CTPv57CqvstqBXmE">
		</script>
		<script type="text/javascript">
			var xhr = new XMLHttpRequest();
			xhr.onload = initializeMap;

			xhr.open("POST", "http://chickenofthesea.herokuapp.com/sendLocation", true);
			xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			
			xhr.onreadystatechange = function(){
				if (xhr.readyState === 4) {
					if (xhr.status === 200) {
						console.log("response is : " + xhr.responseText);
						var coords = getCoords();
						console.log(coords);
						// console.log("lat is : " + coords['lat']);			
					}
				}
			}
			
			xhr.send("login=MichaelCorner&lat=42.3&lng=-71.1");

			function getCoords() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function(e) {
						var coords = {lat: position.coords.latitude,
									  lng: position.coords.longitude};
						console.log("lat is " + position.coords.latitude);
						console.log("in dict, that is " + coords[lat]);
						return coords;
					})
				}
			}
			

			function initializeMap() {
				if (xhr.readyState === 4) {
					if (xhr.status === 200) {

						var coords = getCoords();
						getCoords();

						var mapOptions = {
							center: { lat: 42.3, lng: -71.1},
							zoom: 11
						};
						var map = new google.maps.Map(document.getElementById('map-canvas'),
								mapOptions);

						// addMarkers(map);

					} else {
							console.error("GOT ERROR " + xhr.statusText);
					}
				}
			};

		

		</script>
	</head>
	<body>
		<div id="map-canvas"></div>
	</body>
</html>